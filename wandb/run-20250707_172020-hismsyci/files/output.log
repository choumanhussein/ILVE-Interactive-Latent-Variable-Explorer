Starting training for 25 epochs...
Model parameters: 1,068,820
Training on: cuda
Epoch 0: 100%|██████████████████████████████████████████████████████| 390/390 [00:04<00:00, 89.10it/s, Loss=175.5909, Recon=165.4850, KL=2.5265]
Epoch 0/24
  Train Loss: 199.9035 (Recon: 193.4052, KL: 1.6246)
  Val Loss:   176.9018 (Recon: 166.2874, KL: 2.6536)
✓ New best model saved with val_loss: 176.9018
Epoch 1: 100%|██████████████████████████████████████████████████████| 390/390 [00:04<00:00, 89.49it/s, Loss=180.3033, Recon=166.9576, KL=3.3364]
Epoch 1/24
  Train Loss: 178.6846 (Recon: 166.5039, KL: 3.0452)
  Val Loss:   170.2050 (Recon: 157.1977, KL: 3.2518)
✓ New best model saved with val_loss: 170.2050
Epoch 2: 100%|██████████████████████████████████████████████████████| 390/390 [00:04<00:00, 89.22it/s, Loss=165.2863, Recon=151.8115, KL=3.3687]
Epoch 2/24
  Train Loss: 174.8519 (Recon: 161.2501, KL: 3.4005)
  Val Loss:   167.3145 (Recon: 153.3127, KL: 3.5004)
✓ New best model saved with val_loss: 167.3145
Epoch 3: 100%|██████████████████████████████████████████████████████| 390/390 [00:04<00:00, 89.31it/s, Loss=171.3196, Recon=156.5744, KL=3.6863]
Epoch 3/24
  Train Loss: 172.5752 (Recon: 158.0309, KL: 3.6361)
  Val Loss:   165.2263 (Recon: 150.3887, KL: 3.7094)
✓ New best model saved with val_loss: 165.2263
Epoch 4: 100%|██████████████████████████████████████████████████████| 390/390 [00:04<00:00, 89.25it/s, Loss=174.0050, Recon=158.4549, KL=3.8875]
Epoch 4/24
  Train Loss: 171.0660 (Recon: 155.8567, KL: 3.8023)
  Val Loss:   163.6677 (Recon: 148.3781, KL: 3.8224)
✓ New best model saved with val_loss: 163.6677
Epoch 5: 100%|██████████████████████████████████████████████████████| 390/390 [00:04<00:00, 89.23it/s, Loss=176.6779, Recon=159.8796, KL=4.1996]
Epoch 5/24
  Train Loss: 169.8848 (Recon: 154.1791, KL: 3.9264)
  Val Loss:   163.0636 (Recon: 146.8930, KL: 4.0427)
✓ New best model saved with val_loss: 163.0636
Epoch 6: 100%|██████████████████████████████████████████████████████| 390/390 [00:04<00:00, 89.23it/s, Loss=163.8286, Recon=147.8777, KL=3.9877]
Epoch 6/24
  Train Loss: 169.0311 (Recon: 152.9962, KL: 4.0087)
  Val Loss:   161.9736 (Recon: 146.3819, KL: 3.8979)
✓ New best model saved with val_loss: 161.9736
Epoch 7: 100%|██████████████████████████████████████████████████████| 390/390 [00:04<00:00, 90.07it/s, Loss=168.0646, Recon=151.1643, KL=4.2251]
Epoch 7/24
  Train Loss: 168.3001 (Recon: 151.9813, KL: 4.0797)
  Val Loss:   161.0969 (Recon: 144.8793, KL: 4.0544)
✓ New best model saved with val_loss: 161.0969
Epoch 8: 100%|██████████████████████████████████████████████████████| 390/390 [00:04<00:00, 90.22it/s, Loss=169.7815, Recon=153.2688, KL=4.1282]
Epoch 8/24
  Train Loss: 167.8014 (Recon: 151.3779, KL: 4.1059)
  Val Loss:   161.2349 (Recon: 144.8135, KL: 4.1054)
Epoch 9: 100%|██████████████████████████████████████████████████████| 390/390 [00:04<00:00, 90.04it/s, Loss=162.5342, Recon=146.5992, KL=3.9838]
Epoch 9/24
  Train Loss: 167.3697 (Recon: 150.8002, KL: 4.1424)
  Val Loss:   160.2610 (Recon: 144.1666, KL: 4.0236)
✓ New best model saved with val_loss: 160.2610
Epoch 10: 100%|█████████████████████████████████████████████████████| 390/390 [00:04<00:00, 90.27it/s, Loss=162.6952, Recon=145.8137, KL=4.2204]
Epoch 10/24
  Train Loss: 167.0419 (Recon: 150.3169, KL: 4.1813)
  Val Loss:   160.1539 (Recon: 144.0110, KL: 4.0357)
✓ New best model saved with val_loss: 160.1539
Epoch 11: 100%|█████████████████████████████████████████████████████| 390/390 [00:04<00:00, 89.97it/s, Loss=175.1709, Recon=158.6928, KL=4.1195]
Epoch 11/24
  Train Loss: 166.7781 (Recon: 149.9233, KL: 4.2137)
  Val Loss:   160.7187 (Recon: 144.3461, KL: 4.0932)
Epoch 12: 100%|█████████████████████████████████████████████████████| 390/390 [00:04<00:00, 90.08it/s, Loss=172.9990, Recon=155.9740, KL=4.2563]
Epoch 12/24
  Train Loss: 166.4285 (Recon: 149.4292, KL: 4.2498)
  Val Loss:   159.8531 (Recon: 143.2099, KL: 4.1608)
✓ New best model saved with val_loss: 159.8531
Epoch 13: 100%|█████████████████████████████████████████████████████| 390/390 [00:04<00:00, 89.95it/s, Loss=169.2792, Recon=152.5426, KL=4.1842]
Epoch 13/24
  Train Loss: 166.3134 (Recon: 149.1632, KL: 4.2875)
  Val Loss:   158.8781 (Recon: 142.9397, KL: 3.9846)
✓ New best model saved with val_loss: 158.8781
Epoch 14: 100%|█████████████████████████████████████████████████████| 390/390 [00:04<00:00, 90.02it/s, Loss=168.1947, Recon=151.1046, KL=4.2725]
Epoch 14/24
  Train Loss: 165.9747 (Recon: 148.8306, KL: 4.2860)
  Val Loss:   159.7107 (Recon: 142.7645, KL: 4.2365)
Epoch 15: 100%|█████████████████████████████████████████████████████| 390/390 [00:04<00:00, 90.18it/s, Loss=162.3425, Recon=144.5430, KL=4.4499]
Epoch 15/24
  Train Loss: 165.7510 (Recon: 148.4904, KL: 4.3151)
  Val Loss:   159.4190 (Recon: 142.4091, KL: 4.2525)
Epoch 16: 100%|█████████████████████████████████████████████████████| 390/390 [00:04<00:00, 90.23it/s, Loss=165.3780, Recon=147.6794, KL=4.4246]
Epoch 16/24
  Train Loss: 165.4506 (Recon: 148.0979, KL: 4.3382)
  Val Loss:   158.9081 (Recon: 141.7049, KL: 4.3008)
Epoch 17: 100%|█████████████████████████████████████████████████████| 390/390 [00:04<00:00, 90.24it/s, Loss=164.5164, Recon=146.5363, KL=4.4950]
Epoch 17/24
  Train Loss: 165.4388 (Recon: 147.9756, KL: 4.3658)
  Val Loss:   159.1450 (Recon: 141.6337, KL: 4.3778)
Epoch 18: 100%|█████████████████████████████████████████████████████| 390/390 [00:04<00:00, 90.12it/s, Loss=160.4994, Recon=143.1813, KL=4.3295]
Epoch 18/24
  Train Loss: 165.3145 (Recon: 147.7719, KL: 4.3857)
  Val Loss:   158.8670 (Recon: 141.7513, KL: 4.2789)
✓ New best model saved with val_loss: 158.8670
Epoch 19: 100%|█████████████████████████████████████████████████████| 390/390 [00:04<00:00, 89.01it/s, Loss=162.9338, Recon=146.3324, KL=4.1504]
Epoch 19/24
  Train Loss: 165.0732 (Recon: 147.5413, KL: 4.3830)
  Val Loss:   158.6521 (Recon: 141.8935, KL: 4.1897)
✓ New best model saved with val_loss: 158.6521
Epoch 20: 100%|█████████████████████████████████████████████████████| 390/390 [00:04<00:00, 88.11it/s, Loss=162.9790, Recon=146.0479, KL=4.2328]
Epoch 20/24
  Train Loss: 164.9563 (Recon: 147.4158, KL: 4.3851)
  Val Loss:   158.0405 (Recon: 141.2525, KL: 4.1970)
✓ New best model saved with val_loss: 158.0405
Epoch 21: 100%|█████████████████████████████████████████████████████| 390/390 [00:04<00:00, 87.08it/s, Loss=169.0161, Recon=150.7806, KL=4.5589]
Epoch 21/24
  Train Loss: 165.0378 (Recon: 147.3967, KL: 4.4103)
  Val Loss:   158.2671 (Recon: 141.0133, KL: 4.3135)
Epoch 22: 100%|█████████████████████████████████████████████████████| 390/390 [00:04<00:00, 87.17it/s, Loss=162.5224, Recon=144.6185, KL=4.4760]
Epoch 22/24
  Train Loss: 164.6495 (Recon: 146.9914, KL: 4.4145)
  Val Loss:   157.9109 (Recon: 140.6104, KL: 4.3251)
✓ New best model saved with val_loss: 157.9109
Epoch 23: 100%|█████████████████████████████████████████████████████| 390/390 [00:04<00:00, 87.07it/s, Loss=166.4855, Recon=148.5435, KL=4.4855]
Epoch 23/24
  Train Loss: 164.5734 (Recon: 146.8923, KL: 4.4203)
  Val Loss:   158.1621 (Recon: 140.4626, KL: 4.4249)
Epoch 24: 100%|█████████████████████████████████████████████████████| 390/390 [00:04<00:00, 86.86it/s, Loss=166.4354, Recon=148.5753, KL=4.4650]
Epoch 24/24
  Train Loss: 164.4398 (Recon: 146.6629, KL: 4.4442)
  Val Loss:   157.6608 (Recon: 140.1295, KL: 4.3828)
✓ New best model saved with val_loss: 157.6608

✓ Training completed in 2.2 minutes
Best validation loss: 157.6608
✓ Training completed for β = 4.0
  Best validation loss: 157.6608
✓ Saved model to experiments/checkpoints/beta_vae_4.0.pth
